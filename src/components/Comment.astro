---
// ğŸ› ï¸ åœ¨è¿™é‡Œå¡«å…¥ä½ åœ¨ giscus.app è·å–åˆ°çš„é…ç½®
const giscusConfig = {
	repo: "bbcslook-beep/my-website", // æ¯”å¦‚: afoim/my-blog
	repoId: "R_kgDOQkdeEg", // åˆšæ‰å¤åˆ¶çš„ data-repo-id
	category: "Announcements", // åˆšæ‰é€‰æ‹©çš„åˆ†ç±»
	categoryId: "DIC_kwDOQkdeEs4CzhXL", // åˆšæ‰å¤åˆ¶çš„ data-category-id
	mapping: "pathname", // æ˜ å°„æ–¹å¼ï¼Œé»˜è®¤ pathname å³å¯
	strict: "0",
	reactionsEnabled: "1",
	emitMetadata: "0",
	inputPosition: "top",
	lang: "zh-CN",
	loading: "lazy",
};
---

<div class="giscus-container mt-8">
    <script src="https://giscus.app/client.js"
        data-repo={giscusConfig.repo}
        data-repo-id={giscusConfig.repoId}
        data-category={giscusConfig.category}
        data-category-id={giscusConfig.categoryId}
        data-mapping={giscusConfig.mapping}
        data-strict={giscusConfig.strict}
        data-reactions-enabled={giscusConfig.reactionsEnabled}
        data-emit-metadata={giscusConfig.emitMetadata}
        data-input-position={giscusConfig.inputPosition}
        data-lang={giscusConfig.lang}
        data-loading={giscusConfig.loading}
        data-theme="preferred_color_scheme"
        crossorigin="anonymous"
        async
    ></script>
</div>

<script is:inline>
    // è‡ªåŠ¨åˆ‡æ¢æ—¥é—´/å¤œé—´æ¨¡å¼çš„è„šæœ¬
    function updateGiscusTheme() {
        const theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: { setConfig: { theme } } }, 'https://giscus.app');
    }

    // ç›‘å¬ç½‘é¡µçš„ä¸»é¢˜å˜åŒ–
    const observer = new MutationObserver(updateGiscusTheme);
    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });

    // åˆå§‹åŠ è½½
    document.addEventListener('astro:page-load', () => {
        updateGiscusTheme();
    });
</script>